CREATE DATABASE SMARTMETER_DB;

-- CREATING THE TABLES

CREATE TABLE CUSTOMERS (
	CSTMR_ID INT PRIMARY KEY,
	CSTMR_NAME VARCHAR(30),
	CSTMR_ADDRESS VARCHAR(50),
	CSTMR_REGION VARCHAR(6)
);

CREATE TABLE SMART_METER_READINGS(
	METER_ID INT PRIMARY KEY,
	CSTMR_ID INT,
	LOCATION VARCHAR(12),
	INSTALLED_DATE DATE,
	READING_DATE_TIME DATETIME,
	ENERGY_CONSUMED FLOAT,
	FOREIGN KEY (CSTMR_ID) REFERENCES CUSTOMERS(CSTMR_ID)

);

-- CHECKING STRUCTURE

SELECT * FROM CUSTOMERS
SELECT * FROM SMART_METER_READINGS

-- POPULATING TABLES

INSERT INTO CUSTOMERS 
VALUES(101, 'SOUMYADIP R.','KOL, W. BENGAL','EAST' ),
(102, 'MANJIT M.','JHASUG, ODISHA','EAST' ),
(103, 'NABIVULLA S.','HYD, TELENGANA','SOUTH' ),
(104, 'ANIKET R.','KOL, W. BENGAL','EAST' ),
(105, 'RHISHAB B.','KANPUR, U.P.','NORTH' ),
(106, 'SAHIL K.','AJMER, RAJASTHAN','WEST' )

SELECT * FROM CUSTOMERS

INSERT INTO SMART_METER_READINGS 
VALUES(331,101, 'BASEMENT','2024-06-25','2024-10-09 14:45:00',23.6 ),
(342,102, 'BASEMENT','2024-03-20','2024-04-09 13:45:00',69.6 ),
(353,103, 'ROOFTOP','2024-04-10','2024-05-09 12:45:00',5.6 ),
(364,104, 'ROOFTOP','2024-07-02','2024-09-09 15:45:00',50.6 ),
(375,105, 'ROOFTOP','2024-03-14','2024-05-09 16:45:00',9.6 )

SELECT * FROM SMART_METER_READINGS

-- TASK 1

--QUERY 1
SELECT METER_ID, READING_DATE_TIME, ENERGY_CONSUMED FROM SMART_METER_READINGS WHERE ENERGY_CONSUMED BETWEEN 10 AND 50

--QUERY 2
SELECT METER_ID, READING_DATE_TIME, ENERGY_CONSUMED FROM SMART_METER_READINGS WHERE READING_DATE_TIME BETWEEN '2024-01-01' AND '2024-12-31'

--QUERY 3
SELECT METER_ID, READING_DATE_TIME, ENERGY_CONSUMED FROM SMART_METER_READINGS WHERE INSTALLED_DATE < '2024-06-30'


-- TASK 2

--QUERY 1 AND 2 IN SAME LINE
SELECT AVG(ENERGY_CONSUMED) AVG_VALUE, MAX(ENERGY_CONSUMED) MAX_VALUE FROM SMART_METER_READINGS 
WHERE READING_DATE_TIME BETWEEN '2024-01-01' AND '2024-12-31';

